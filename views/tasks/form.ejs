<%- include("../layout", {
  body: `
    <div class="container" style="max-width: 600px;">

      <a href="${isEdit ? 'javascript:history.back()' : `/clients/${clientId}`}" class="btn btn-link mb-3">
        ← Back to Client
      </a>

      <h2 class="mb-4">
        ${isEdit ? 'Edit Task' : 'Add New Task'}
      </h2>

      <form
        method="POST"
        action="${isEdit ? `/tasks/${task.id}/edit` : `/clients/${clientId}/tasks/new`}"
        class="card p-4 shadow-sm"
      >

        <!-- TASK TITLE -->
        <div class="mb-3">
          <label class="form-label">Task Title</label>
          <input
            type="text"
            name="title"
            class="form-control"
            placeholder="Enter task title"
            value="${task ? task.title : ''}"
            required
          />
        </div>

        <!-- ✅ NEW: DESCRIPTION -->
        <div class="mb-3">
          <label class="form-label">Description</label>
          <textarea
            name="description"
            class="form-control"
            rows="3"
            placeholder="Task details..."
          >${task && task.description ? task.description : ''}</textarea>
        </div>

        <!-- ✅ NEW: ASSIGNED TO -->
        <div class="mb-3">
          <label class="form-label">Assigned To</label>
          <input
            type="text"
            name="assigned_to"
            class="form-control"
            placeholder="Person responsible"
            value="${task && task.assigned_to ? task.assigned_to : ''}"
          />
        </div>

        <!-- DUE DATE -->
        <div class="mb-3">
          <label class="form-label">Due Date</label>
          <input
            type="date"
            name="due_date"
            class="form-control"
            value="${task && task.due_date ? task.due_date : ''}"
          />
        </div>

        <!-- STATUS (STANDARDIZED) -->
        <div class="mb-4">
          <label class="form-label">Status</label>
          <select name="status" class="form-select">
            <option value="pending" ${!task || task.status === 'pending' ? 'selected' : ''}>
              Pending
            </option>
            <option value="in_progress" ${task && task.status === 'in_progress' ? 'selected' : ''}>
              In Progress
            </option>
            <option value="completed" ${task && task.status === 'completed' ? 'selected' : ''}>
              Completed
            </option>
          </select>
        </div>

        <!-- BUTTONS -->
        <div class="d-flex justify-content-end">
          <button type="submit" class="btn btn-primary me-2">
            ${isEdit ? 'Update Task' : 'Save Task'}
          </button>

          <a href="${isEdit ? 'javascript:history.back()' : `/clients/${clientId}`}"
             class="btn btn-light">
            Cancel
          </a>
        </div>

      </form>
    </div>
  `
}) %>
